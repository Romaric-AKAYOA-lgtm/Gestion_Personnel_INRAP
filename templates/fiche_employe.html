{% extends 'template_base.html' %}

{% block contenue %}
<div class="container mt-4">
    <!-- En-tête de la page -->
    <div class="text-center">
        <h2>INRAP - République du Congo</h2>
        <h4>Ministère de l'Emploi et du Travail</h4>
        <p><strong>Devise : Unité, Travail, Progrès</strong></p>
        <hr>
    </div>
    
    <!-- Titre de la fiche employé -->
    <div class="text-center">
        <h3>Fiche Employé</h3>
        <p><strong>Date de Création:</strong> {{ employe.date_creation }}</p>
    </div>
    
    <!-- Détails de l'employé -->
    <div class="mb-4">
        <h4>Informations de l'Employé</h4>
        <p><strong>Nom:</strong> {{ employe.nom }} {{ employe.prenom }}</p>
        <p><strong>Email:</strong> {{ employe.email }}</p>
        <p><strong>Poste:</strong> {{ employe.poste }}</p>
        <p><strong>Unité Organisationnelle:</strong> {{ employe.organisation.nom }}</p>
        <p><strong>Responsable:</strong> {{ employe.responsable }}</p>
    </div>
    
    <!-- Signature Electronique -->
    <div class="mb-4">
        <h4>Signature</h4>
        <canvas id="signature-pad" class="signature-pad" width="400" height="150"></canvas>
        <div>
            <button id="clear-signature" class="btn btn-warning">Effacer</button>
            <button id="save-signature" class="btn btn-success">Enregistrer la Signature</button>
        </div>
    </div>

    <!-- Liste des employés partant en congé cette année -->
    <div class="mb-4">
        <h4>Employés Partant en Congé Cette Année</h4>
        <ul>
            {% for cong in conges_annee %}
                <li>{{ cong.employe.nom }} - Début du Congé : {{ cong.date_debut }} - Fin du Congé : {{ cong.date_fin }}</li>
            {% endfor %}
        </ul>
    </div>
    
    <!-- Liste des employés partant en retraite cette année -->
    <div class="mb-4">
        <h4>Employés Partant en Retraite Cette Année</h4>
        <ul>
            {% for retraite in retraite_annee %}
                <li>{{ retraite.employe.nom }} - Date de Retraite : {{ retraite.date_retraite }}</li>
            {% endfor %}
        </ul>
    </div>
    
    <!-- Liste des employés de retour de congé cette année -->
    <div class="mb-4">
        <h4>Employés de Retour de Congé Cette Année</h4>
        <ul>
            {% for retour in retours_conges %}
                <li>{{ retour.employe.nom }} - Date de Retour : {{ retour.date_retour }}</li>
            {% endfor %}
        </ul>
    </div>

    <!-- Zone de Signature -->
    <div class="signature-zone text-end">
        <p>Lieu: ____________________</p>
        <p>Signature: ____________________</p>
    </div>
</div>

<!-- Scripts pour la signature électronique -->
<script src="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js"></script>

<script>
    // Initialisation de Signature Pad
    const canvas = document.getElementById("signature-pad");
    const signaturePad = new SignaturePad(canvas);

    document.getElementById("clear-signature").addEventListener("click", function () {
        signaturePad.clear();
    });

    document.getElementById("save-signature").addEventListener("click", function () {
        if (!signaturePad.isEmpty()) {
            const signatureDataUrl = signaturePad.toDataURL();
            console.log("Signature enregistrée : ", signatureDataUrl);
            // Vous pouvez envoyer cette signature à votre serveur pour stockage
        } else {
            alert("Veuillez dessiner une signature.");
        }
    });

    // Imprimer la page
    function imprimerFiche() {
        window.print();
    }
    
    // Option d'impression par section
    window.onload = function () {
        imprimerFiche();
    };
</script>
{% endblock %}
